import {
	Box,
	Input,
	Text,
	InputLeftElement,
	InputGroup,
} from "@chakra-ui/react";
import { useEffect, useMemo, useState } from "react";
import "../styles/home.scss";
import { Search2Icon } from "@chakra-ui/icons";
import RenderImagesList from "../components/ImagesList";
import { useDispatch, useSelector } from "react-redux";
import { getImages } from "../redux/actions/images";
import { toast } from "react-hot-toast";

export default function Home() {
	const dispatch = useDispatch();
	const [searchText, setSearchText] = useState("");

	const { images = [], isLoading = true } = useSelector(
		(state) => state.images
	);

	const imagesList = useMemo(() => {
		if (searchText === "") return [...images];
		return images.filter(({ prompt }) => prompt.includes(searchText));
	}, [images, searchText]);

	const handleChange = (e) => {
		const { value } = e.target;
		setSearchText(value);
	};

	useEffect(() => {
		try {
			dispatch(getImages());
		} catch (error) {
			console.log("error");
			toast.error(error?.message || error);
		}

		return () => {};
	}, []);

	return (
        <Box className="home-page">
            <Box>
                
            </Box>
			<Text fontSize="xl" as="b">
				Look what the people are up to.
			</Text>
			<Text fontSize="md" color="gray">
				Explore a collection of imaginative and visually stunning images
				generated by OpenAI's DALL-E AI
			</Text>

			<InputGroup mt={5}>
				<InputLeftElement children={<Search2Icon color="gray.300" />} />
				<Input
					className="search-input"
					placeholder="Search here..."
					onChange={handleChange}
					value={searchText}
				/>
			</InputGroup>

			<RenderImagesList isLoading={isLoading} images={imagesList} />
			{/* <IconButton
				className="btn-back-to-top"
				aria-label="Search database"
				onClick={() => window.scrollTo({ top: 0, behavior: "smooth" })}
				icon={<TriangleUpIcon />}
			/> */}
		</Box>
	);
}
